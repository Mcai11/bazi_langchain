# å…«å­—åˆ†æç³»ç»Ÿæµ‹è¯•æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æŒ‡å—è¯¦ç»†ä»‹ç»å¦‚ä½•æµ‹è¯•å…«å­—åˆ†æç³»ç»Ÿçš„è¾“å‡ºç»“æœï¼Œç¡®ä¿ç³»ç»ŸåŠŸèƒ½æ­£å¸¸ã€æ•°æ®å®Œæ•´ã€JSONè¾“å‡ºå¯ç”¨ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. æœ€ç®€å•çš„æµ‹è¯•

```python
from bazi_analyzer import BaziAnalyzer

# åˆ›å»ºåˆ†æå™¨
analyzer = BaziAnalyzer(1985, 1, 17, 14, 'ç”·', use_gregorian=True)

# è·å–ç»“æœ
result = analyzer.get_result()
print(f"åˆ†æå®Œæˆï¼ŒåŒ…å«{len(result)}ä¸ªä¸»è¦å­—æ®µ")
```

### 2. ä½¿ç”¨ç°æˆçš„æµ‹è¯•è„šæœ¬

```bash
# å¿«é€ŸåŠŸèƒ½éªŒè¯
python quick_test.py

# å®Œæ•´é“¾è·¯æµ‹è¯•
python test_complete_chain.py

# æŸ¥çœ‹æ¼”ç¤º
python demo_output.py
```

## ğŸ§ª æµ‹è¯•æ–¹æ³•è¯¦è§£

### æ–¹æ³•1ï¼šåŸºç¡€åŠŸèƒ½æµ‹è¯•

**ç›®çš„**ï¼šéªŒè¯æ ¸å¿ƒåŠŸèƒ½æ˜¯å¦æ­£å¸¸

```python
def test_basic_functions():
    analyzer = BaziAnalyzer(1985, 1, 17, 14, 'ç”·', use_gregorian=True)
    
    # æ£€æŸ¥å…«å­—è®¡ç®—
    assert analyzer.gans is not None
    assert analyzer.zhis is not None
    assert analyzer.me is not None
    
    # æ£€æŸ¥æ¨¡å—åˆ›å»º
    assert analyzer.core_module is not None
    assert analyzer.basic_info_module is not None
    assert analyzer.liunian_analysis_module is not None
    
    print("âœ… åŸºç¡€åŠŸèƒ½æµ‹è¯•é€šè¿‡")
```

### æ–¹æ³•2ï¼šJSONè¾“å‡ºæµ‹è¯•

**ç›®çš„**ï¼šéªŒè¯JSONè¾“å‡ºçš„å®Œæ•´æ€§å’Œå¯ç”¨æ€§

```python
import json

def test_json_output():
    analyzer = BaziAnalyzer(1985, 1, 17, 14, 'ç”·', use_gregorian=True)
    result = analyzer.get_result()
    
    # æµ‹è¯•JSONåºåˆ—åŒ–
    try:
        json_str = json.dumps(result, ensure_ascii=False, indent=2)
        print(f"âœ… JSONåºåˆ—åŒ–æˆåŠŸ: {len(json_str)} å­—ç¬¦")
        
        # æµ‹è¯•ååºåˆ—åŒ–
        restored = json.loads(json_str)
        assert len(restored) == len(result)
        print("âœ… JSONå¾€è¿”è½¬æ¢æˆåŠŸ")
        
        return json_str
    except Exception as e:
        print(f"âŒ JSONæµ‹è¯•å¤±è´¥: {e}")
        return None
```

### æ–¹æ³•3ï¼šæ•°æ®å®Œæ•´æ€§æµ‹è¯•

**ç›®çš„**ï¼šéªŒè¯å…³é”®æ•°æ®æ˜¯å¦å®Œæ•´

```python
def test_data_completeness():
    analyzer = BaziAnalyzer(1985, 1, 17, 14, 'ç”·', use_gregorian=True)
    result = analyzer.get_result()
    
    # æ£€æŸ¥å¿…è¦å­—æ®µ
    required_fields = ['input_info', 'analysis_results']
    for field in required_fields:
        assert field in result, f"ç¼ºå°‘å­—æ®µ: {field}"
    
    # æ£€æŸ¥åˆ†ææ¨¡å—
    analysis = result['analysis_results']
    required_modules = [
        'basic_info', 'bazi_main', 'liunian_analysis', 
        'dayun_analysis', 'personality_analysis'
    ]
    for module in required_modules:
        assert module in analysis, f"ç¼ºå°‘æ¨¡å—: {module}"
    
    # æ£€æŸ¥æµå¹´æ•°æ®
    liunian = analysis['liunian_analysis']
    liunian_data = liunian.get('liunian_data', {})
    assert len(liunian_data) >= 100, f"æµå¹´æ•°æ®ä¸è¶³: {len(liunian_data)}å¹´"
    
    print("âœ… æ•°æ®å®Œæ•´æ€§æµ‹è¯•é€šè¿‡")
```

### æ–¹æ³•4ï¼šæ€§èƒ½æµ‹è¯•

**ç›®çš„**ï¼šéªŒè¯ç³»ç»Ÿæ€§èƒ½æ˜¯å¦æ»¡è¶³è¦æ±‚

```python
import time

def test_performance():
    # æµ‹è¯•åˆ›å»ºæ—¶é—´
    start_time = time.time()
    analyzer = BaziAnalyzer(1985, 1, 17, 14, 'ç”·', use_gregorian=True)
    creation_time = time.time() - start_time
    
    # æµ‹è¯•JSONç”Ÿæˆæ—¶é—´
    start_time = time.time()
    result = analyzer.get_result()
    json_str = json.dumps(result, ensure_ascii=False)
    json_time = time.time() - start_time
    
    print(f"åˆ›å»ºæ—¶é—´: {creation_time:.3f}ç§’")
    print(f"JSONç”Ÿæˆ: {json_time:.3f}ç§’")
    print(f"æ•°æ®å¤§å°: {len(json_str)/1024:.1f}KB")
    
    # æ€§èƒ½è¦æ±‚
    assert creation_time < 5.0, "åˆ›å»ºæ—¶é—´è¿‡é•¿"
    assert json_time < 1.0, "JSONç”Ÿæˆæ—¶é—´è¿‡é•¿"
    assert len(json_str) > 50000, "æ•°æ®é‡ä¸è¶³"
    
    print("âœ… æ€§èƒ½æµ‹è¯•é€šè¿‡")
```

### æ–¹æ³•5ï¼šLLMé›†æˆæµ‹è¯•

**ç›®çš„**ï¼šéªŒè¯ä¸LLMé›†æˆçš„å¯ç”¨æ€§

```python
def test_llm_integration():
    analyzer = BaziAnalyzer(1985, 1, 17, 14, 'ç”·', use_gregorian=True)
    result = analyzer.get_result()
    
    # æå–LLMéœ€è¦çš„å…³é”®ä¿¡æ¯
    analysis = result.get('analysis_results', {})
    
    # åŸºæœ¬ä¿¡æ¯
    basic_info = analysis.get('basic_info', {})
    assert 'dates' in basic_info
    
    # å…«å­—ä¸»ä½“
    bazi_main = analysis.get('bazi_main', {})
    assert 'basic_bazi' in bazi_main
    assert 'strength_analysis' in bazi_main
    
    # æµå¹´åˆ†æ
    liunian = analysis.get('liunian_analysis', {})
    assert 'liunian_data' in liunian
    
    print("âœ… LLMé›†æˆæµ‹è¯•é€šè¿‡")
```

## ğŸ“Š æµ‹è¯•è„šæœ¬è¯´æ˜

### ç°æœ‰æµ‹è¯•è„šæœ¬

| è„šæœ¬åç§° | ç”¨é€” | è¿è¡Œæ—¶é—´ | é€‚ç”¨åœºæ™¯ |
|---------|------|----------|----------|
| `quick_test.py` | å¿«é€ŸåŠŸèƒ½éªŒè¯ | <10ç§’ | å¼€å‘è°ƒè¯• |
| `test_complete_chain.py` | å®Œæ•´é“¾è·¯æµ‹è¯• | 30-60ç§’ | å‘å¸ƒéªŒè¯ |
| `demo_output.py` | åŠŸèƒ½æ¼”ç¤º | 10-20ç§’ | å­¦ä¹ ä½¿ç”¨ |
| `verify_final_json.py` | JSONéªŒè¯ | <5ç§’ | æ•°æ®æ£€æŸ¥ |

### æµ‹è¯•è„šæœ¬ä½¿ç”¨æ–¹æ³•

```bash
# 1. å¿«é€ŸéªŒè¯ï¼ˆæ¨èæ—¥å¸¸ä½¿ç”¨ï¼‰
python quick_test.py

# 2. å®Œæ•´æµ‹è¯•ï¼ˆæ¨èå‘å¸ƒå‰ä½¿ç”¨ï¼‰
python test_complete_chain.py

# 3. æŸ¥çœ‹æ¼”ç¤ºï¼ˆæ¨èæ–°ç”¨æˆ·ï¼‰
python demo_output.py

# 4. éªŒè¯JSONï¼ˆæ¨èé›†æˆå‰ä½¿ç”¨ï¼‰
python verify_final_json.py
```

## ğŸ¯ æµ‹è¯•é‡ç‚¹

### å¿…é¡»éªŒè¯çš„åŠŸèƒ½

1. **å…«å­—è®¡ç®—æ­£ç¡®æ€§**
   - å¤©å¹²åœ°æ”¯è®¡ç®—
   - åç¥åˆ†æ
   - äº”è¡Œåˆ†æ•°

2. **æµå¹´æ•°æ®å®Œæ•´æ€§**
   - 101å¹´å®Œæ•´æ•°æ®
   - 95å²å¹´ä»½åŒ…å«
   - æ•°æ®ç»“æ„ä¸€è‡´

3. **JSONè¾“å‡ºå¯ç”¨æ€§**
   - åºåˆ—åŒ–æˆåŠŸ
   - ååºåˆ—åŒ–æ— æŸ
   - ç»“æ„å®Œæ•´

4. **æ¨¡å—é›†æˆå®Œæ•´æ€§**
   - æ‰€æœ‰10ä¸ªæ¨¡å—åˆ›å»ºæˆåŠŸ
   - æ•°æ®æµæ­£ç¡®ä¼ é€’
   - æ— æ¨¡å—ç¼ºå¤±

### æ€§èƒ½è¦æ±‚

- **åˆ›å»ºæ—¶é—´**: < 5ç§’
- **JSONç”Ÿæˆ**: < 1ç§’  
- **æ•°æ®å¤§å°**: > 50KB
- **å†…å­˜ä½¿ç”¨**: < 100MB

## ğŸ”§ è‡ªå®šä¹‰æµ‹è¯•

### åˆ›å»ºè‡ªå®šä¹‰æµ‹è¯•ç”¨ä¾‹

```python
def custom_test():
    # æµ‹è¯•ä¸åŒçš„å‡ºç”Ÿæ—¥æœŸ
    test_cases = [
        (1985, 1, 17, 14, 'ç”·'),  # ç»å…¸æ¡ˆä¾‹
        (1990, 6, 15, 10, 'å¥³'),  # å¥³å‘½æµ‹è¯•
        (2000, 12, 31, 23, 'ç”·'), # è¾¹ç•Œæ—¥æœŸ
    ]
    
    for year, month, day, hour, gender in test_cases:
        try:
            analyzer = BaziAnalyzer(year, month, day, hour, gender, use_gregorian=True)
            result = analyzer.get_result()
            
            # éªŒè¯åŸºæœ¬ä¿¡æ¯
            basic_bazi = result['analysis_results']['bazi_main']['basic_bazi']
            print(f"{year}-{month}-{day} {gender}å‘½: {' '.join([f'{g}{z}' for g, z in zip(basic_bazi['gans'], basic_bazi['zhis'])])}")
            
        except Exception as e:
            print(f"æµ‹è¯•å¤±è´¥ {year}-{month}-{day}: {e}")
```

### éªŒè¯ç‰¹å®šæ•°æ®

```python
def verify_specific_data():
    analyzer = BaziAnalyzer(1985, 1, 17, 14, 'ç”·', use_gregorian=True)
    
    # ç›´æ¥è®¿é—®æ¨¡å—æ•°æ®
    if analyzer.liunian_analysis_module:
        liunian_data = analyzer.liunian_analysis_module.liunian_data
        
        # éªŒè¯95å²æ•°æ®
        target_year = 1985 + 95 - 1
        if target_year in liunian_data:
            data_95 = liunian_data[target_year]
            print(f"95å²æ•°æ®: {data_95['age']}å² {data_95['year']}å¹´ {data_95['ganzhi']}")
        else:
            print("âŒ 95å²æ•°æ®ç¼ºå¤±")
```

## ğŸ“ è¾“å‡ºæ–‡ä»¶è¯´æ˜

### JSONç»“æœæ–‡ä»¶

- `complete_bazi_result.json`: å®Œæ•´æµ‹è¯•ç»“æœ
- `test_output_result.json`: è¾“å‡ºæµ‹è¯•ç»“æœ  
- `demo_result_*.json`: æ¼”ç¤ºç»“æœæ–‡ä»¶

### æ–‡ä»¶ç»“æ„

```json
{
  "input_info": {
    "year": 1985,
    "month": 1,
    "day": 17,
    "hour": 14,
    "gender": "ç”·",
    "use_gregorian": true
  },
  "analysis_results": {
    "basic_info": {...},
    "bazi_main": {...},
    "liunian_analysis": {
      "liunian_data": {
        "1985": {...},
        "1986": {...},
        ...
        "2085": {...}
      }
    },
    ...
  }
}
```

## â— å¸¸è§é—®é¢˜

### Q1: JSONåºåˆ—åŒ–å¤±è´¥
**åŸå› **: æ•°æ®ä¸­åŒ…å«ä¸å¯åºåˆ—åŒ–çš„å¯¹è±¡
**è§£å†³**: æ£€æŸ¥æ•°æ®ç±»å‹ï¼Œç¡®ä¿æ‰€æœ‰æ•°æ®éƒ½æ˜¯åŸºæœ¬ç±»å‹

### Q2: æµå¹´æ•°æ®ä¸å®Œæ•´
**åŸå› **: `get_result()`æ–¹æ³•é™åˆ¶äº†è¿”å›æ•°æ®
**è§£å†³**: ç›´æ¥è®¿é—®`analyzer.liunian_analysis_module.liunian_data`

### Q3: æ¨¡å—åˆ›å»ºå¤±è´¥
**åŸå› **: ä¾èµ–æ¨¡å—å¯¼å…¥å¤±è´¥
**è§£å†³**: æ£€æŸ¥`try-except ImportError`å—ï¼Œç¡®ä¿å¤‡ç”¨é€»è¾‘æ­£å¸¸

### Q4: æ€§èƒ½é—®é¢˜
**åŸå› **: å¤§é‡æ•°æ®è®¡ç®—å¯¼è‡´
**è§£å†³**: ä½¿ç”¨ç¼“å­˜æœºåˆ¶ï¼Œé¿å…é‡å¤è®¡ç®—

## ğŸ‰ æµ‹è¯•é€šè¿‡æ ‡å‡†

### åŸºç¡€è¦æ±‚
- âœ… æ‰€æœ‰æ ¸å¿ƒæ¨¡å—åˆ›å»ºæˆåŠŸ
- âœ… JSONè¾“å‡ºæ­£å¸¸ï¼Œå¤§å°>50KB
- âœ… æµå¹´æ•°æ®101å¹´å®Œæ•´
- âœ… 95å²å¹´ä»½æ•°æ®å­˜åœ¨

### é«˜çº§è¦æ±‚
- âœ… æ€§èƒ½æ»¡è¶³è¦æ±‚ï¼ˆ<5ç§’åˆ›å»ºï¼‰
- âœ… å†…å­˜ä½¿ç”¨åˆç†ï¼ˆ<100MBï¼‰
- âœ… é”™è¯¯å¤„ç†æœºåˆ¶å¥å…¨
- âœ… LLMé›†æˆå‹å¥½

### å‘å¸ƒæ ‡å‡†
- âœ… æ‰€æœ‰æµ‹è¯•è„šæœ¬é€šè¿‡
- âœ… å¤šç§æµ‹è¯•ç”¨ä¾‹éªŒè¯
- âœ… æ–‡æ¡£å’Œç¤ºä¾‹å®Œæ•´
- âœ… ä»£ç è´¨é‡è‰¯å¥½

---

**æœ€åæ›´æ–°**: 2025-01-22
**ç‰ˆæœ¬**: 1.0.0 