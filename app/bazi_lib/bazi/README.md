# 八字分析系统

## 简介

- bazi.py 八字排盘，能比常用的排盘更清晰地显示冲、合、刑等关系，计算五行分数
- luohou.py 计算罗喉日时,用于提示风水师何时慎用罗盘
- shengxiao.py 用户生肖合婚等

## 功能特色

本项目专注于八字计算和分析，提供现代化的程序接口：

- **模块化设计** - 将八字分析分解为13个独立模块
- **结构化输出** - 提供JSON格式的分析结果，便于程序调用
- **LLM友好** - 专门优化的数据格式，适合AI分析
- **关系分析** - 详细的天干地支关系分析
- **大运流年** - 完整的时间运势分析
- **神煞分析** - 全面的神煞识别和解析
- **现代接口** - FastAPI接口，支持Web调用

## 安装

安装依赖库：

```bash
pip install bidict lunar_python colorama fastapi uvicorn
```

## 使用

### 基本八字排盘

```bash
python bazi.py -g 1985 1 17 14
```

### 生肖合婚

```bash
python shengxiao.py 虎
```

输出示例：
```
你的生肖是： 虎
你的年支是： 寅
================================================================================
与你三合的生肖：马狗
与你六合的生肖：猪
与你三会的生肖：兔龙
================================================================================
与你相冲的生肖：猴
你刑的生肖：蛇
被你刑的生肖：猴
与你相害的生肖：蛇
与你相破的生肖：猪
================================================================================
```

### 计算罗喉日时

```bash
python luohou.py
```

### API接口调用

```bash
# 启动API服务
uvicorn bazi_interpret:app --reload

# 调用接口
curl -X POST "http://localhost:8000/bazi_analyze" \
     -H "Content-Type: application/json" \
     -d '{"year": 1985, "month": 1, "day": 17, "hour": 14, "gender": "男"}'
```

## 模块结构

本系统包含以下13个核心模块：

1. **CoreBaseModule** - 核心基础计算
2. **BasicInfoModule** - 基本信息输出
3. **BaziMainModule** - 八字主体分析
4. **DetailInfoModule** - 详细信息表格
5. **ShensAnalysisModule** - 神煞分析
6. **ZhiRelationsModule** - 地支关系
7. **DayunAnalysisModule** - 大运分析
8. **LiunianAnalysisModule** - 流年分析
9. **格局分析模块** - 格局识别（待开发）
10. **六亲分析模块** - 六亲关系（待开发）
11. **性格分析模块** - 性格特征（待开发）
12. **事业分析模块** - 事业运势（待开发）
13. **健康分析模块** - 健康状况（待开发）

## 输出格式

### 结构化JSON输出

```json
{
  "basic_info": {
    "birth_date": "1985-01-17",
    "gender": "男",
    "ganzhi": ["甲子", "丁丑", "丙辰", "癸巳"]
  },
  "bazi_analysis": {
    "daymaster": "丙",
    "strength": "强",
    "scores": {"金": 3, "木": 7, "水": 18, "火": 15, "土": 17}
  },
  "dayun_analysis": {
    "start_age": 8,
    "direction": "顺行",
    "dayun_list": [...]
  },
  "liunian_analysis": {
    "current_year": 2024,
    "fortune_level": "吉",
    "main_influences": [...]
  }
}
```

### 传统表格输出

保持与原版bazi.py兼容的表格格式输出，便于传统命理师使用。

## 特色功能

### 1. 智能关系分析

- 天干合化关系识别
- 地支六合、六冲、三合局、三会局
- 复杂的刑害破关系
- 拱合拱会特殊格局

### 2. 时间运势分析

- 精确的大运起运时间计算
- 大运与命局的相互作用
- 流年与大运命局的三重关系
- 运势吉凶评估和建议

### 3. 神煞系统

- 全面的神煞识别（100+种）
- 按年月日时分类的神煞分析
- 神煞组合的特殊影响
- 吉凶神煞的平衡评估

### 4. LLM优化

- 专门为AI分析设计的数据格式
- 清晰的语义标签和分类
- 结构化的时间轴数据
- 便于自然语言生成的模板

## 技术架构

- **Python 3.7+** - 核心开发语言
- **lunar_python** - 精确的农历计算
- **FastAPI** - 现代Web API框架
- **Pydantic** - 数据验证和序列化
- **模块化设计** - 便于扩展和维护

## 开发状态

- ✅ 核心基础模块
- ✅ 基本信息模块
- ✅ 八字主体分析
- ✅ 详细信息模块
- ✅ 神煞分析模块
- ✅ 地支关系模块
- ✅ 大运分析模块
- ✅ 流年分析模块
- 🚧 格局分析模块（开发中）
- 🚧 六亲分析模块（开发中）
- 🚧 性格分析模块（开发中）
- 🚧 事业分析模块（开发中）
- 🚧 健康分析模块（开发中）

## 贡献

欢迎提交Issue和Pull Request来改进这个项目。

## 许可证

本项目遵循开源许可证，具体请查看LICENSE文件。

## 联系方式

技术支持：钉钉或微信 pythontesting 